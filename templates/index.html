
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TaskMate | Turn Thoughts into Action</title>
  <meta name="description" content="Experience the future of productivity with AI-powered voice recognition, intelligent task management, and seamless calendar integration." />
  
  <!-- Open Graph tags -->
  <meta property="og:title" content="TaskMate | Turn Thoughts into Action" />
  <meta property="og:description" content="Experience the future of productivity with AI-powered voice recognition, intelligent task management, and seamless calendar integration." />
  <meta property="og:type" content="website" />

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />

  <!-- Font Awesome -->
  <script src="https://kit.fontawesome.com/a54d2cbf95.js" crossorigin="anonymous"></script>
  
  <!-- Three.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  
  <!-- GSAP for animations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <style>
    :root {
      --clr-primary: hsl(248, 84%, 63%);
      --clr-secondary: hsl(195, 100%, 50%);
      --clr-accent: hsl(262, 83%, 58%);
      --clr-accent-2: hsl(188, 94%, 43%);
      --clr-bg: hsl(240, 21%, 6%);
      --clr-bg-light: hsl(240, 21%, 18%);
      --clr-dark: hsl(240, 21%, 18%);
      --clr-light: hsl(0, 0%, 100%);
      --clr-glass: hsla(0, 0%, 100%, 0.15);
      --clr-glass-border: hsla(0, 0%, 100%, 0.2);
      --radius-lg: 1.5rem;
      --radius-xl: 2rem;
      --transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-bounce: 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;}

    body {
      background: var(--clr-bg);
      color: var(--clr-light);
      line-height: 1.6;
      overflow-x: hidden;
      position: relative;
    }

    html {
      scroll-behavior: smooth;
    }

    /* Loading Screen */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--clr-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    .loading-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loader {
      width: 50px;
      height: 50px;
      border: 3px solid hsla(0, 0%, 100%, 0.1);
      border-top: 3px solid var(--clr-primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Scroll Progress Bar */
    .scroll-progress {
      position: fixed;
      top: 0;
      left: 0;
      width: 0%;
      height: 3px;
      background: linear-gradient(90deg, var(--clr-primary), var(--clr-secondary));
      z-index: 9999;
      transition: width 0.1s ease;
    }

    /* 3D Background Canvas */
    .bg-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.8;
    }

    /* Floating Shapes */
    .floating-shapes {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }

    .shape {
      position: absolute;
      background: linear-gradient(45deg, var(--clr-primary), var(--clr-secondary));
      border-radius: 50%;
      opacity: 0.1;
      animation: float 20s infinite linear;
    }

    .shape:nth-child(1) { width: 80px; height: 80px; top: 20%; left: 10%; animation-delay: 0s; }
    .shape:nth-child(2) { width: 120px; height: 120px; top: 60%; left: 80%; animation-delay: -5s; }
    .shape:nth-child(3) { width: 60px; height: 60px; top: 80%; left: 20%; animation-delay: -10s; }
    .shape:nth-child(4) { width: 100px; height: 100px; top: 30%; left: 70%; animation-delay: -15s; }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); }
      33% { transform: translateY(-30px) rotate(120deg) scale(1.1); }
      66% { transform: translateY(15px) rotate(240deg) scale(0.9); }
    }

    /* Page Sections */
    .page-section {
      display: none;
    }

    .page-section.active {
      display: block;
    }
#chat-icon {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #007bff;
      color: white;
      padding: 12px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 24px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    /* Glassmorphism Navbar */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: var(--clr-glass);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--clr-glass-border);
      z-index: 1000;
      transition: var(--transition);
    }

    .navbar.scrolled {
      background: hsla(240, 21%, 6%, 0.9);
      backdrop-filter: blur(30px);
    }

    .nav-wrapper {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 1.8rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 30px hsla(248, 84%, 63%, 0.5);
      cursor: pointer;
    }

    .nav-links {
      list-style: none;
      display: flex;
      gap: 2.5rem;
    }

    .nav-link {
      text-decoration: none;
      color: var(--clr-light);
      font-weight: 500;
      position: relative;
      transition: var(--transition);
      padding: 0.5rem 1rem;
      border-radius: var(--radius-lg);
      cursor: pointer;
    }

    .nav-link::before {
      content: "";
      position: absolute;
      inset: 0;
      background: var(--clr-glass);
      border-radius: var(--radius-lg);
      opacity: 0;
      transition: var(--transition);
      z-index: -1;
    }

    .nav-link:hover::before {
      opacity: 1;
    }

    .nav-link:hover {
      transform: translateY(-2px);
      text-shadow: 0 0 20px hsla(0, 0%, 100%, 0.5);
    }

    .nav-link.active {
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      color: var(--clr-light);
    }

    /* Mobile Menu */
    .hamburger {
      display: none;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      padding: 0.5rem;
    }

    .hamburger span {
      width: 25px;
      height: 3px;
      background: var(--clr-light);
      transition: var(--transition);
      border-radius: 2px;
    }

    /* Enhanced Hero */
    .hero {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      align-items: center;
      gap: 3rem;
      min-height: 100vh;
      position: relative;
      overflow: hidden;
      perspective: 1000px;
      padding: 120px 1.5rem 80px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .hero::before {
      content: "";
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, var(--clr-primary) 0%, var(--clr-secondary) 50%, transparent 70%);
      opacity: 0.1;
      animation: rotate 30s infinite linear;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .hero-content {
      z-index: 2;
      transform-style: preserve-3d;
    }

    .hero-title {
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      margin-bottom: 1.5rem;
      line-height: 1.1;
      font-weight: 800;
      background: linear-gradient(135deg, var(--clr-light), var(--clr-accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: textGlow 3s ease-in-out infinite alternate;
    }

    @keyframes textGlow {
      from { text-shadow: 0 0 20px hsla(0, 0%, 100%, 0.5); }
      to { text-shadow: 0 0 40px hsla(262, 83%, 58%, 0.8); }
    }

    .hero-description {
      font-size: 1.25rem;
      margin-bottom: 2.5rem;
      max-width: 500px;
      opacity: 0.9;
      line-height: 1.7;
    }

    /* 3D Button */
    .btn-3d {
      display: inline-block;
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      color: var(--clr-light);
      padding: 1rem 2.5rem;
      border-radius: var(--radius-xl);
      font-weight: 600;
      font-size: 1.1rem;
      text-decoration: none;
      position: relative;
      transform: perspective(1000px) rotateX(0deg);
      transition: var(--transition-bounce);
      box-shadow: 
        0 10px 30px hsla(248, 84%, 63%, 0.4),
        inset 0 1px 0 hsla(0, 0%, 100%, 0.2);
      border: 1px solid hsla(0, 0%, 100%, 0.1);
      cursor: pointer;
    }

    .btn-3d::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--clr-secondary), var(--clr-accent));
      border-radius: var(--radius-xl);
      opacity: 0;
      transition: var(--transition);
    }

    .btn-3d:hover {
      transform: perspective(1000px) rotateX(10deg) translateY(-5px);
      box-shadow: 
        0 20px 50px hsla(248, 84%, 63%, 0.6),
        inset 0 1px 0 hsla(0, 0%, 100%, 0.3);
    }

    .btn-3d:hover::before {
      opacity: 1;
    }

    .btn-3d span {
      position: relative;
      z-index: 1;
    }

    /* Features Grid */
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 2.5rem;
      perspective: 1000px;
      padding: 2rem 1.5rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    /* 3D Feature Cards */
    .feature-card {
      background: var(--clr-glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--clr-glass-border);
      border-radius: var(--radius-xl);
      padding: 2.5rem;
      position: relative;
      transition: var(--transition);
      transform-style: preserve-3d;
      cursor: pointer;
      overflow: hidden;
    }

    .feature-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--clr-primary), transparent);
      opacity: 0;
      transition: var(--transition);
    }

    .feature-card:hover {
      transform: perspective(1000px) rotateX(5deg) rotateY(5deg) translateZ(20px);
      box-shadow: 
        0 25px 60px hsla(0, 0%, 0%, 0.3),
        0 10px 30px hsla(248, 84%, 63%, 0.2);
      border-color: var(--clr-primary);
    }

    .feature-card:hover::before {
      opacity: 1;
    }

    .feature-card-icon {
      font-size: 2.5rem;
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1.5rem;
      display: block;
      transform: translateZ(10px);
    }

    .feature-card-title {
      margin-bottom: 1rem;
      font-size: 1.4rem;
      font-weight: 700;
      transform: translateZ(5px);
    }

    .feature-card-description {
      font-size: 1rem;
      opacity: 0.9;
      line-height: 1.7;
      margin-bottom: 1.5rem;
    }

    /* Page Container Styles */
    .page-container {
      min-height: 100vh;
      padding: 120px 1.5rem 80px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .page-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .page-title {
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 800;
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 1rem;
    }

    .page-subtitle {
      font-size: 1.1rem;
      opacity: 0.8;
      max-width: 600px;
      margin: 0 auto;
    }

    /* Task Management Styles */
    .task-input-section {
      margin-bottom: 3rem;
      background: var(--clr-glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--clr-glass-border);
      border-radius: var(--radius-xl);
      padding: 2rem;
    }

    .input-container {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .task-input-field {
      flex: 1;
      padding: 1rem 1.5rem;
      background: hsla(0, 0%, 100%, 0.1);
      border: 1px solid hsla(0, 0%, 100%, 0.2);
      border-radius: var(--radius-lg);
      color: var(--clr-light);
      font-size: 1rem;
      transition: var(--transition);
    }

    .task-input-field:focus {
      outline: none;
      border-color: var(--clr-primary);
      box-shadow: 0 0 0 2px hsla(248, 84%, 63%, 0.2);
      background: hsla(0, 0%, 100%, 0.15);
    }

    .task-input-field::placeholder {
      color: hsla(0, 0%, 100%, 0.6);
    }

    .glass-button {
      padding: 1rem 1.5rem;
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      border: none;
      border-radius: var(--radius-lg);
      color: var(--clr-light);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .glass-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .glass-button::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: hsla(0, 0%, 100%, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.3s ease, height 0.3s ease;
    }

    .glass-button:hover::before {
      width: 100px;
      height: 100px;
    }

    .glass-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px hsla(248, 84%, 63%, 0.4);
    }

    .glass-button.listening {
      background: linear-gradient(135deg, #ef4444, #f97316);
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1) translateY(0); }
      50% { transform: scale(1.05) translateY(-2px); }
    }

    /* Task Statistics */
    .task-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .stat-card {
      background: var(--clr-glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--clr-glass-border);
      border-radius: var(--radius-xl);
      padding: 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
      transition: var(--transition);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px hsla(0, 0%, 0%, 0.2);
    }

    .stat-icon {
      font-size: 2rem;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--clr-primary), var(--clr-secondary));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-content {
      flex: 1;
    }

    .stat-number {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--clr-light);
      line-height: 1;
    }

    .stat-label {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-top: 0.25rem;
    }

    /* Sticky Notes Container */
    .sticky-notes-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      min-height: 150px;
      margin-bottom: 2rem;
    }

    /* Sticky Note Styles */
    .sticky-note {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      border-radius: var(--radius-lg);
      padding: 1.5rem;
      color: #333;
      position: relative;
      cursor: pointer;
      transition: var(--transition);
      transform: rotate(-2deg);
      box-shadow: 
        0 5px 15px rgba(0, 0, 0, 0.1),
        0 2px 5px rgba(0, 0, 0, 0.05);
      min-height: 120px;
      display: flex;
      flex-direction: column;
    }

    .sticky-note:nth-child(even) {
      transform: rotate(1deg);
    }

    .sticky-note:nth-child(3n) {
      background: linear-gradient(135deg, #ff6b9d, #ff8e9e);
      color: white;
    }

    .sticky-note:nth-child(4n) {
      background: linear-gradient(135deg, #4ecdc4, #44a08d);
      color: white;
    }

    .sticky-note:nth-child(5n) {
      background: linear-gradient(135deg, #a8e6cf, #88d8a3);
      color: #333;
    }

    .sticky-note:nth-child(6n) {
      background: linear-gradient(135deg, #ffd93d, #ff6b35);
      color: #333;
    }

    .sticky-note:hover {
      transform: rotate(0deg) scale(1.05);
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.2),
        0 5px 15px rgba(0, 0, 0, 0.1);
      z-index: 10;
    }

    .sticky-note.completed {
      opacity: 0.7;
      transform: rotate(0deg);
      background: linear-gradient(135deg, #95a5a6, #7f8c8d);
      color: white;
    }

    .sticky-note.completed .task-text {
      text-decoration: line-through;
    }

    /* Sticky Note Content */
    .task-text {
      font-size: 1rem;
      font-weight: 600;
      line-height: 1.4;
      margin-bottom: 1rem;
      flex: 1;
      word-wrap: break-word;
    }

    .task-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: auto;
      padding-top: 1rem;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      font-size: 0.8rem;
    }

    .task-date {
      opacity: 0.8;
      font-weight: 500;
    }

    .task-actions {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      display: flex;
      gap: 0.5rem;
      opacity: 0;
      transition: var(--transition);
    }

    .sticky-note:hover .task-actions {
      opacity: 1;
    }

    .task-action-btn-ct {
      width: 28px;
      height: 28px;
      border: none;
      border-radius: 50%;
      background: rgba(227, 10, 10, 0.1);
      color: inherit;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
    }

    .task-action-btn-ct:hover {
      background: linear-gradient(135deg, #029622 0%, #1de982 50%, #0a7d3c 100%);
      transform: scale(1.1);
    }
    .task-action-btn-dt {
      width: 28px;
      height: 28px;
      border: none;
      border-radius: 50%;
      background: rgba(227, 10, 10, 0.1);
      color: inherit;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
    }

    .task-action-btn-dt:hover {
      background: linear-gradient(135deg, rgba(226, 2, 2, 0.523) 0%, rgba(174, 0, 0, 0.966) 50%, rgba(255,80,80,0.2) 100%);
      transform: scale(1.1);
    }

    /* Calendar Styles */
    .calendar-container {
      background: var(--clr-glass);
      backdrop-filter: blur(20px);
      border: 1px solid var(--clr-glass-border);
      border-radius: var(--radius-xl);
      padding: 2rem;
      overflow: hidden;
      margin-bottom: 2rem;
    }

    .calendar-header {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 1px;
      margin-bottom: 1rem;
    }

    .day-header {
      text-align: center;
      padding: 1rem 0.5rem;
      background: hsla(0, 0%, 100%, 0.05);
      font-weight: 600;
      font-size: 0.9rem;
      color: var(--clr-light);
      border-radius: var(--radius-lg);
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 1px;
      background: hsla(0, 0%, 100%, 0.05);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .calendar-day {
      background: var(--clr-bg-light);
      min-height: 120px;
      padding: 0.75rem 0.5rem;
      border: 1px solid transparent;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .calendar-day:hover {
      background: hsla(0, 0%, 100%, 0.05);
      border-color: var(--clr-primary);
    }

    .calendar-day.today {
      background: linear-gradient(135deg, hsla(248, 84%, 63%, 0.2), hsla(195, 100%, 50%, 0.2));
      border-color: var(--clr-primary);
    }

    .calendar-day.other-month {
      opacity: 0.3;
      background: hsla(0, 0%, 100%, 0.02);
    }

    .calendar-day.has-events {
      border-color: var(--clr-secondary);
    }

    .day-number {
      font-size: 1rem;
      font-weight: 600;
      color: var(--clr-light);
      margin-bottom: 0.5rem;
      line-height: 1;
    }

    .calendar-day.other-month .day-number {
      color: hsla(0, 0%, 100%, 0.4);
    }

    .day-events {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
      overflow: hidden;
    }

    .event-indicator {
      background: var(--clr-secondary);
      color: var(--clr-light);
      padding: 2px 6px;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.2;
    }

    .event-indicator.work {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    }

    .event-indicator.personal {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .event-indicator.meeting {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    /* Error message styling */
    .error-message {
      color: #ef4444;
      font-size: 0.875rem;
      margin-top: 0.5rem;
      display: none;
    }

    /* Footer Enhancement */
    .footer {
      text-align: center;
      padding: 4rem 1.5rem 2rem;
      background: var(--clr-glass);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--clr-glass-border);
      color: hsla(0, 0%, 100%, 0.8);
      font-size: 0.95rem;
      margin-top: 5rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .hero {
        text-align: center;
        padding: 100px 1rem 50px;
      }

      .features-grid {
        grid-template-columns: 1fr;
        gap: 2rem;
      }

      .feature-card {
        padding: 2rem 1.5rem;
      }

      .btn-3d {
        padding: 0.875rem 2rem;
        font-size: 1rem;
      }

      .nav-links {
        position: fixed;
        top: 80px;
        right: -100%;
        flex-direction: column;
        background: var(--clr-glass);
        backdrop-filter: blur(20px);
        width: 250px;
        padding: 2rem;
        gap: 1.5rem;
        border-radius: var(--radius-xl) 0 0 var(--radius-xl);
        border: 1px solid var(--clr-glass-border);
        transition: var(--transition);
      }

      .nav-links.active {
        right: 0;
      }

      .hamburger {
        display: flex;
      }

      .input-container {
        flex-direction: column;
      }

      .task-stats {
        grid-template-columns: 1fr;
      }

      .sticky-notes-container {
        grid-template-columns: 1fr;
      }

      .sticky-note {
        transform: rotate(0deg);
      }

      .sticky-note:hover {
        transform: scale(1.02);
      }

      .calendar-grid {
        gap: 0;
      }

      .calendar-day {
        min-height: 80px;
        padding: 0.5rem 0.25rem;
      }
    }

    /* Animation for new items */
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px) rotate(-5deg);
      }
      to {
        opacity: 1;
        transform: translateY(0) rotate(-2deg);
      }
    }

    .sticky-note.new {
      animation: slideInUp 0.5s ease-out;
    }

    /* Notification styles */
    .notification {
      position: fixed;
      top: 100px;
      right: 20px;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 12px;
      font-weight: 600;
      z-index: 10000;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }

    .notification.success {
      background: #22c55e;
    }

    .notification.error {
      background: #ef4444;
    }

    .notification.info {
      background: #3b82f6;
    }
  </style>
</head>
<body>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loader"></div>
  </div>

  <!-- Scroll Progress Bar -->
  <div class="scroll-progress" id="scrollProgress"></div>

  <!-- Three.js Background -->
  <canvas class="bg-canvas" id="bgCanvas"></canvas>
  <div class="floating-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
  </div>

  <!-- Navigation -->
  <header class="navbar" id="navbar">
    <div class="nav-wrapper">
      <div class="logo" onclick="showSection('home')">TaskMate</div>

      <nav class="desktop-nav">
        <ul class="nav-links">
          <li><span class="nav-link active" onclick="showSection('home')">Home</span></li>
          <li><span class="nav-link" onclick="showSection('tasks')">Tasks</span></li>
          <li><span class="nav-link" onclick="showSection('calendar')">Calendar</span></li>
          <li><span class="nav-link" onclick="showSection('about')">About</span></li>
        </ul>
      </nav>

      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>

      
    </div>
  </header>
<div id="chat-icon" onclick="goToChat()">💬</div>
  <!-- Home Section -->
  <div id="home" class="page-section active">
    <!-- Hero Section -->
    <section class="hero">
      <div class="hero-content">
        <h1 class="hero-title">Turn Your Thoughts into Action</h1>
        <p class="hero-description">
            Experience the future of productivity with AI-powered voice recognition,
          intelligent task management, and seamless calendar integration.
        </p>
        <button class="btn-3d" onclick="showSection('tasks')">
          <span>Start Your Journey</span>
        </button>
      </div>
    </section>
 
  
    <!-- Features Section -->
    <section class="features-section">
      <div class="features-grid">
        
        <!-- Smart To-Do List -->
        <div class="feature-card" data-tilt onclick="showSection('tasks')">
          <i class="fas fa-brain feature-card-icon"></i>
          <h2 class="feature-card-title">Smart To-Do List</h2>
          <p class="feature-card-description">Add tasks by typing or speaking with advanced AI processing. Our intelligent system organizes and prioritizes your thoughts automatically.</p>
        </div>

        <!-- Calendar Integration -->
        <div class="feature-card" data-tilt onclick="showSection('calendar')">
          <i class="fas fa-calendar-alt feature-card-icon"></i>
          <h2 class="feature-card-title">Smart Calendar</h2>
          <p class="feature-card-description">Automatically schedule tasks and events with intelligent time management. Never miss important deadlines again.</p>
        </div>

        <!-- AI Notifications -->
        <div class="feature-card" data-tilt>
          <i class="fas fa-robot feature-card-icon"></i>
          <h2 class="feature-card-title">AI-Powered Notifications</h2>
          <p class="feature-card-description">Get intelligent reminders and notifications powered by TaskMate.</p>
        </div>
      </div>
    </section>
  </div>

  <!-- Tasks Section -->
  <div id="tasks" class="page-section">
    <div class="page-container">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">Smart Task Management</h1>
        <p class="page-subtitle">Organize your thoughts into actionable sticky notes</p>
      </div>

      <!-- Task Input Section -->
      <div class="task-input-section">
        <div class="input-container">
          <input type="text" id="taskInput" placeholder="What's on your mind? Type or speak..." class="task-input-field" />
          <button id="addTaskBtn" class="glass-button">
            <i class="fas fa-plus"></i> Add Task
          </button>
          <button id="speakBtn" class="glass-button">
            <i class="fas fa-microphone"></i> Speak
          </button>
        </div>
        <div id="speechError" class="error-message"></div>
      </div>

      <!-- Task Statistics -->
      <div class="task-stats">
        <div class="stat-card">
          <div class="stat-icon">📝</div>
          <div class="stat-content">
            <div class="stat-number" id="totalTasks">0</div>
            <div class="stat-label">Total Tasks</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">✅</div>
          <div class="stat-content">
            <div class="stat-number" id="completedTasks">0</div>
            <div class="stat-label">Completed</div>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">🔥</div>
          <div class="stat-content">
            <div class="stat-number" id="todayTasks">0</div>
            <div class="stat-label">Today</div>
          </div>
        </div>
      </div>
 <section id="todo" class="page-section">
    <div class="page-container">
      <div class="page-header">
        <h2 class="page-title">Smart To-Do List</h2>
        <p class="page-subtitle">Manage your tasks with intelligent voice recognition and AI-powered organization</p>
      </div>
      
      <div class="todo-container">
        <!-- Input Section -->
        <div class="todo-input-section fade-in">
          <div class="input-group">
            <input type="text" class="todo-input" id="todoInput" placeholder="What needs to be done?">
            <button class="voice-btn" id="voiceBtn" title="Click to speak">
              <i class="fas fa-microphone"></i>
            </button>
            <select class="priority-select" id="prioritySelect">
              <option value="low">Low Priority</option>
              <option value="medium">Medium Priority</option>
              <option value="high">High Priority</option>
            </select>
            <button class="add-btn" id="addBtn">Add Task</button>
          </div>
        </div>

        <!-- Task List -->
        <div class="todo-list" id="todoList">
          <!-- Empty state will be shown here initially -->
        </div>
      </div>
    </div>
  </section>
      <!-- Sticky Notes Container -->
      <div class="sticky-notes-container" id="taskContainer">
        <!-- Tasks will be dynamicallyki added here -->
      </div>
    </div>
  </div>

  <!-- Calendar Section -->
  <div id="calendar" class="page-section">
    <div class="page-container">
      <!-- Page Header -->
      <div class="page-header">
        <h1 class="page-title">Smart Calendar</h1>
        <p class="page-subtitle">Visualize your schedule with intelligent task integration</p>
      </div>

      <!-- Calendar Container -->
      <div class="calendar-container">
        <div class="calendar-header">
          <div class="day-header">Sun</div>
          <div class="day-header">Mon</div>
          <div class="day-header">Tue</div>
          <div class="day-header">Wed</div>
          <div class="day-header">Thu</div>
          <div class="day-header">Fri</div>
          <div class="day-header">Sat</div>
        </div>
        <div class="calendar-grid" id="calendarGrid">
          <!-- Calendar days will be generated here -->
        </div>
      </div>
      
      
      
        <i class="fas fa-comments"></i>
      </button>
      <!-- Event Input Section -->
      <div class="task-input-section">
        <h3 style="margin-bottom: 1rem; color: var(--clr-light);">Add Calendar Event</h3>
        <div class="input-container">
          <input type="text" id="eventTitle" placeholder="Event title..." class="task-input-field" />
          <input type="datetime-local" id="eventDateTime" class="task-input-field" />
          <button id="addEventBtn" class="glass-button">
            <i class="fas fa-calendar-plus"></i> Add Event
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- About Section -->
  <div id="about" class="page-section">
    <div class="page-container">
      <div class="page-header">
        <h1 class="page-title">About TaskMate</h1>
        <p class="page-subtitle">The future of productivity is here</p>
      </div>
      
      <div class="features-grid">
        <div class="feature-card">
          <i class="fas fa-rocket feature-card-icon"></i>
          <h2 class="feature-card-title">Modern Technology</h2>
          <p class="feature-card-description">Built with cutting-edge web technologies including Three.js for 3D graphics, Web Speech API for voice recognition, and advanced CSS animations.</p>
        </div>
        
        <div class="feature-card">
          <i class="fas fa-brain feature-card-icon"></i>
          <h2 class="feature-card-title">Intelligent Design</h2>
          <p class="feature-card-description">Our AI-powered system learns from your patterns and helps optimize your productivity with smart suggestions and automated organization.</p>
        </div>
        
        <div class="feature-card">
          <i class="fas fa-shield-alt feature-card-icon"></i>
          <h2 class="feature-card-title">Privacy First</h2>
          <p class="feature-card-description">All your data is stored locally in your browser. We believe in privacy by design and never collect or share your personal information.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    © <span id="currentYear"></span> TaskMate. Powered by cutting-edge AI technology.
  </footer>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>
    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAxhL77J1VfZJd3rqRyR-AtlPYSnZoXnn4",
      authDomain: "task-mate-90eee.firebaseapp.com",
      projectId: "task-mate-90eee",
      storageBucket: "task-mate-90eee.firebasestorage.app",
      messagingSenderId: "112228413597",
      appId: "1:112228413597:web:9f77d62ecf0478394f6474",
      measurementId: "G-YVTN10T1Q2"
    };
    
    // Initialize Firebase
    // Initialize Firebase
// Initialize Firebase only if not already initialized
if (!firebase.apps || !firebase.apps.length) {
  firebase.initializeApp(firebaseConfig);
} else {
  firebase.app();
}
const database = firebase.database();

// Create user-specific references instead of global ones
function getUserTasksRef() {
  const user = firebase.auth().currentUser;
  return user ? database.ref('users/' + user.uid + '/tasks') : null;
}

function getUserEventsRef() {
  const user = firebase.auth().currentUser;
  return user ? database.ref('users/' + user.uid + '/events') : null;
}
    // Global variables
    let particleSystem = null;
    let animationId = null;
    let tasks = [];
    let events = [];
    let taskCounter = 0;
    let currentDate = new Date();
        // Make functions globally available
    window.loadTasksFromFirebase = loadTasksFromFirebase;
    window.addTask = addTask;
    window.toggleTask = toggleTask;
    window.deleteTask = deleteTask;
    window.renderTasks = renderTasks;
    window.updateStatistics = updateStatistics;
    // Initialize everything when page loads
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
    });
    function goToChat() {
      window.location.href = "/c";  // Redirect to chatbot page
    }
    // Update your initialization function
function initializeApp() {
  // Hide loading screen after a delay
  setTimeout(() => {
    document.getElementById('loadingOverlay').classList.add('hidden');
  }, 1000);

  // Set current year
  document.getElementById('currentYear').textContent = new Date().getFullYear();

  // Initialize Three.js background
  initThreeJS();

  // Setup event listeners
  setupEventListeners();

  // Setup scroll effects
  setupScrollEffects();

  // Setup reveal animations
  setupRevealAnimations();

  // Setup 3D card effects
  setup3DCardEffects();

  // Request notification permission
  requestNotificationPermission();

  // Set up notification checks
  setupNotificationChecks();

  // Check authentication state first, then load data
  firebase.auth().onAuthStateChanged(function(user) {
    if (user) {
      console.log("User is authenticated:", user.email);
      loadTasksFromFirebase();
      loadEventsFromFirebase();
      updateStatistics();
    } else {
      console.log("No user is authenticated");
      // Handle unauthenticated state
    }
  });
}
   
function addTask(taskText) {
  // Validate input
  if (!taskText || !taskText.trim()) {
    console.log("Empty task text, not adding task");
    return;
  }

  // Check authentication
  const user = firebase.auth().currentUser;
  if (!user) {
    console.log("No authenticated user found");
    showNotification('You need to be logged in to add tasks', 'error');
    return;
  }

  console.log("Creating task for user:", user.uid);
  
  // Create task object with all necessary fields
  const task = {
    text: taskText.trim(),
    title: taskText.trim(),
    userId: user.uid,
    completed: false,
    createdAt: new Date().toISOString(),
    dueDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
  };

  // Get reference to user's tasks collection
  const userTasksRef = firebase.database().ref('users/' + user.uid + '/tasks');
  
  // Push new task
  userTasksRef.push().set(task)
    .then(() => {
      console.log("Task added successfully:", task);
      showNotification('Task added successfully!', 'success');
      
      // Force refresh tasks from Firebase
      loadTasksFromFirebase();
      
      // Update statistics explicitly
      updateStatistics();
    })
    .catch((error) => {
      console.error("Error adding task:", error);
      showNotification('Error adding task: ' + error.message, 'error');
    });
  }
    function loadEventsFromFirebase() {
  // Get current user
  const user = firebase.auth().currentUser;
  if (!user) {
    console.log("No authenticated user found");
    events = []; // Clear events array
    renderCalendar();
    return;
  }
  
  const userEventsRef = firebase.database().ref('users/' + user.uid + '/events');
  userEventsRef.on('value', (snapshot) => {
    events = [];
    snapshot.forEach((childSnapshot) => {
      const eventData = childSnapshot.val();
      events.push({
        id: childSnapshot.key,
        ...eventData
      });
    });
    renderCalendar();
  });
}

// Add this before updateStatistics
function getTodayTasksCount() {
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  return tasks.filter(task => {
    const taskDate = new Date(task.createdAt);
    taskDate.setHours(0, 0, 0, 0);
    return taskDate.getTime() === today.getTime();
  }).length;
}
function loadTasksFromFirebase() {
  console.log("Loading tasks from Firebase");
  
  const user = firebase.auth().currentUser;
  if (!user) {
    console.log("No authenticated user found");
    tasks = []; // Clear tasks array
    renderTasks();
    updateStatistics();
    return;
  }
  
  console.log("Loading tasks for user:", user.uid);
  const userEventsRef = database.ref('users/' + user.uid + '/events');
userEventsRef.on('value', (snapshot) => {
  events = [];
  snapshot.forEach((childSnapshot) => {
    const eventData = childSnapshot.val();
    events.push({
      id: childSnapshot.key,
      ...eventData
    });
  });
  renderCalendar();
});
  const userTasksRef = firebase.database().ref('users/' + user.uid + '/tasks');
  userTasksRef.on('value', (snapshot) => {
    console.log("Tasks snapshot received");
    tasks = [];
    
    snapshot.forEach((childSnapshot) => {
      const taskData = childSnapshot.val();
      tasks.push({
        id: childSnapshot.key,
        ...taskData
      });
    });
    
    console.log("Loaded tasks:", tasks.length);
    renderTasks();
    updateStatistics();
  }, (error) => {
    console.error("Error loading tasks:", error);
    showNotification('Error loading tasks: ' + error.message, 'error');
  });
}
    // Firebase data loading functions
    // In index.html, update the loadTasksFromFirebase function

    // Three.js Background Setup
    function initThreeJS() {
      const canvas = document.getElementById('bgCanvas');
      if (!canvas || !window.THREE) return;

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      const renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);

      // Create particles
      const particleCount = 100;
      const positions = new Float32Array(particleCount * 3);
      const velocities = [];

      for (let i = 0; i < particleCount; i++) {
        positions[i * 3] = (Math.random() - 0.5) * 10;
        positions[i * 3 + 1] = (Math.random() - 0.5) * 10;
        positions[i * 3 + 2] = (Math.random() - 0.5) * 10;
        
        velocities.push({
          x: (Math.random() - 0.5) * 0.01,
          y: (Math.random() - 0.5) * 0.01,
          z: (Math.random() - 0.5) * 0.01
        });
      }

      const geometry = new THREE.BufferGeometry();
      geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

      const material = new THREE.PointsMaterial({
        color: 0x5d5fef,
        size: 0.05,
        transparent: true,
        opacity: 0.6
      });

      const particles = new THREE.Points(geometry, material);
      scene.add(particles);
      camera.position.z = 5;

      particleSystem = { scene, camera, renderer, particles, velocities };

      // Animation loop
      function animate() {
        if (particleSystem) {
          animateParticles();
        }
        animationId = requestAnimationFrame(animate);
      }
      animate();

      // Handle resize
      window.addEventListener('resize', () => {
        if (particleSystem) {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
        }
      });
    }

    function animateParticles() {
      if (!particleSystem) return;

      const { particles, velocities, renderer, scene, camera } = particleSystem;
      const particleCount = velocities.length;

      // Update particle positions
      const positions = particles.geometry.attributes.position.array;
      for (let i = 0; i < particleCount; i++) {
        positions[i * 3] += velocities[i].x;
        positions[i * 3 + 1] += velocities[i].y;
        positions[i * 3 + 2] += velocities[i].z;

        // Wrap around screen
        if (positions[i * 3] > 5) positions[i * 3] = -5;
        if (positions[i * 3] < -5) positions[i * 3] = 5;
        if (positions[i * 3 + 1] > 5) positions[i * 3 + 1] = -5;
        if (positions[i * 3 + 1] < -5) positions[i * 3 + 1] = 5;
      }
      particles.geometry.attributes.position.needsUpdate = true;

      particles.rotation.x += 0.001;
      particles.rotation.y += 0.002;

      renderer.render(scene, camera);
    }

    // Section Navigation
    // In index.html, modify the showSection function (around line 1483)
function showSection(sectionName) {
  // Hide all sections
  document.querySelectorAll('.page-section').forEach(section => {
    section.classList.remove('active');
  });

  // Show selected section
  document.getElementById(sectionName).classList.add('active');

  // Update navigation active state
  document.querySelectorAll('.nav-link').forEach(link => {
    link.classList.remove('active');
  });

  // Find and activate current nav link
  document.querySelectorAll('.nav-link').forEach(link => {
    if (link.textContent.toLowerCase() === sectionName || 
        (sectionName === 'home' && link.textContent.toLowerCase() === 'home')) {
      link.classList.add('active');
    }
  });

  // Close mobile menu - FIX: Check if the element exists before accessing it
  const mobileNavLinks = document.getElementById('mobileNavLinks');
  if (mobileNavLinks) {
    mobileNavLinks.classList.remove('active');
  }

  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });

  // Re-render sections that need updates
  if (sectionName === 'tasks') {
    renderTasks();
    updateStatistics();
  } else if (sectionName === 'calendar') {
    renderCalendar();
  }
}
// Add this before initializeApp
function setup3DCardEffects() {
  const cards = document.querySelectorAll('[data-tilt]');
  cards.forEach(card => {
    card.addEventListener('mousemove', (e) => {
      const cardRect = card.getBoundingClientRect();
      const cardCenterX = cardRect.left + cardRect.width / 2;
      const cardCenterY = cardRect.top + cardRect.height / 2;
      const angleY = -(e.clientX - cardCenterX) * 0.05;
      const angleX = (e.clientY - cardCenterY) * 0.05;
      card.style.transform = `perspective(1000px) rotateX(${angleX}deg) rotateY(${angleY}deg)`;
    });
    
    card.addEventListener('mouseleave', () => {
      card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
    });
  });
}
    // Event Listeners Setup
    function setupEventListeners() {
      // Mobile menu toggle
      const hamburger = document.getElementById('hamburger');
      const mobileNavLinks = document.getElementById('mobileNavLinks');
      
      if (hamburger && mobileNavLinks) {
        hamburger.addEventListener('click', () => {
          mobileNavLinks.classList.toggle('active');
        });
      }

      // Task management
      const taskInput = document.getElementById('taskInput');
      const addTaskBtn = document.getElementById('addTaskBtn');
      const speakBtn = document.getElementById('speakBtn');

      if (addTaskBtn) {
        addTaskBtn.addEventListener('click', () => {
          const value = taskInput.value.trim();
          if (value) {
            addTask(value);
            taskInput.value = '';
          }
        });
      }

      if (taskInput) {
        taskInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            const value = taskInput.value.trim();
            if (value) {
              addTask(value);
              taskInput.value = '';
            }
          }
        });
      }

      // Add event listeners for the Smart To-Do List section
      const todoInput = document.getElementById('todoInput');
      const addBtn = document.getElementById('addBtn');

      if (addBtn) {
        addBtn.addEventListener('click', () => {
          const value = todoInput.value.trim();
          if (value) {
            addTask(value);
            todoInput.value = '';
          }
        });
      }

      if (todoInput) {
        todoInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            const value = todoInput.value.trim();
            if (value) {
              addTask(value);
              todoInput.value = '';
            }
          }
        });
      }

      // Speech recognition
      if (speakBtn) {
        speakBtn.addEventListener('click', startSpeechRecognition);
      }

      // Event management
      const eventTitle = document.getElementById('eventTitle');
      const eventDateTime = document.getElementById('eventDateTime');
      const addEventBtn = document.getElementById('addEventBtn');

      if (addEventBtn) {
        addEventBtn.addEventListener('click', () => {
          const title = eventTitle.value.trim();
          const dateTime = eventDateTime.value;
          if (title && dateTime) {
            addEvent(title, dateTime);
            eventTitle.value = '';
            eventDateTime.value = '';
          }
        });
      }

      if (eventTitle) {
        eventTitle.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            const title = eventTitle.value.trim();
            const dateTime = eventDateTime.value;
            if (title && dateTime) {
              addEvent(title, dateTime);
              eventTitle.value = '';
              eventDateTime.value = '';
            }
          }
        });
      }
    }
    

    // Speech Recognition
    function startSpeechRecognition() {
      const speakBtn = document.getElementById('speakBtn');
      const speechError = document.getElementById('speechError');
      const taskInput = document.getElementById('taskInput');

      if (!('SpeechRecognition' in window) && !('webkitSpeechRecognition' in window)) {
        showError('Speech recognition is not supported in this browser');
        return;
      }

      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const recognition = new SpeechRecognition();

      recognition.lang = 'en-US';
      recognition.continuous = false;
      recognition.interimResults = false;

      speakBtn.classList.add('listening');
      speakBtn.innerHTML = '<i class="fas fa-microphone-slash"></i> Listening...';
      speakBtn.disabled = true;
      speechError.style.display = 'none';

      recognition.onstart = () => {
        console.log('Speech recognition started');
      };

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        taskInput.value = transcript;
        addTask(transcript);
        taskInput.value = '';
      };

      recognition.onerror = (event) => {
        showError(`Speech recognition error: ${event.error}`);
      };

      recognition.onend = () => {
        speakBtn.classList.remove('listening');
        speakBtn.innerHTML = '<i class="fas fa-microphone"></i> Speak';
        speakBtn.disabled = false;
      };

      recognition.start();
    }

    function showError(message) {
      const speechError = document.getElementById('speechError');
      speechError.textContent = message;
      speechError.style.display = 'block';
      setTimeout(() => {
        speechError.style.display = 'none';
      }, 5000);
    }

    // Task Management
   // In index.html, update the addTask function
function addEvent(title, dateTime) {
  if (!title.trim() || !dateTime) return;
  
  const user = firebase.auth().currentUser;
  if (!user) {
    showNotification('You need to be logged in to create events', 'error');
    return;
  }

  const event = {
    title: title.trim(),
    datetime: dateTime,
    userId: user.uid,
    createdAt: new Date().toISOString()
  };

  // Save to Firebase under user's events
  const userEventsRef = database.ref('users/' + user.uid + '/events');
  const newEventRef = userEventsRef.push();
  newEventRef.set(event).then(() => {
    showNotification('Event added successfully!', 'success');
  }).catch((error) => {
    console.error('Error adding event:', error);
    showNotification('Error adding event!', 'error');
  });
}
// Add Task function (fixes missing function declaration)
function addTask(taskText) {
  const user = firebase.auth().currentUser;
  if (!user) {
    showNotification('You need to be logged in to add tasks', 'error');
    return;
  }
  if (!taskText.trim()) return;

  const task = {
    text: taskText.trim(),
    title: taskText.trim(),
    userId: user.uid,
    completed: false,
    createdAt: new Date().toISOString(),
    dueDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString()
  };

  // Save to Firebase under this user's data
  const userTasksRef = firebase.database().ref('users/' + user.uid + '/tasks');
  const newTask = userTasksRef.push();
  newTask.set(task).then(() => {
    showNotification('Task added successfully!', 'success');
  }).catch((error) => {
    console.error('Error adding task:', error);
    showNotification('Error adding task!', 'error');
  });
}
    
    // In index.html, update the toggleTask function
function toggleTask(taskId) {
  const user = firebase.auth().currentUser;
  if (!user) return;
  
  const task = tasks.find(t => t.id === taskId);
  if (task) {
    const updatedTask = {
      ...task,
      completed: !task.completed,
      completedAt: !task.completed ? new Date().toISOString() : null
    };
    
    // Remove the id property before saving
    delete updatedTask.id;
    
    // Update in user's tasks node
    firebase.database().ref(`users/${user.uid}/tasks/${taskId}`).update(updatedTask)
      .then(() => {
        const message = updatedTask.completed ? 'Task completed!' : 'Task marked incomplete';
        showNotification(message, 'success');
      })
      .catch((error) => {
        console.error('Error updating task:', error);
        showNotification('Error updating task!', 'error');
      });
  }
}

// In index.html, update the deleteTask function
function deleteTask(taskId) {
  const user = firebase.auth().currentUser;
  if (!user) return;
  
  if (confirm('Are you sure you want to delete this task?')) {
    // Delete from user's tasks node
    firebase.database().ref(`users/${user.uid}/tasks/${taskId}`).remove()
      .then(() => {
        showNotification('Task deleted successfully!', 'success');
      })
      .catch((error) => {
        console.error('Error deleting task:', error);
        showNotification('Error deleting task!', 'error');
      });
  }
}

   function renderTasks() {
  const container = document.getElementById('taskContainer');
  container.innerHTML = '';
  
  // Remove login check and directly show tasks or empty state
  
  if (tasks.length === 0) {
    container.innerHTML = `
      <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: hsla(0, 0%, 100%, 0.6);">
        <i class="fas fa-clipboard-list" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
        <h3>No tasks yet</h3>
        <p>Add some tasks to get started!</p>
      </div>
    `;
    return;
  }

  tasks.forEach((task, index) => {
    const taskElement = createTaskElement(task, index);
    container.appendChild(taskElement);
  });
}

   function createTaskElement(task, index) {
  const taskElement = document.createElement('div');
  taskElement.className = `sticky-note ${task.completed ? 'completed' : ''} new`;
  taskElement.innerHTML = `
    <div class="task-actions">
      <button class="task-action-btn-ct" onclick="toggleTask('${task.id}')" title="${task.completed ? 'Mark incomplete' : 'Mark complete'}">
        <i class="fas fa-${task.completed ? 'undo' : 'check'}"></i>
      </button>
     <button class="task-action-btn-dt" onclick="deleteTask('${task.id}')" title="Delete task">
  <i class="fas fa-trash-alt"></i>
</button>
    </div>
    <div class="task-text">${escapeHtml(task.title || task.text || '')}</div>
    <div class="task-meta">
      <div class="task-date">${formatDate(task.createdAt)}</div>
    </div>
  `;

  // Remove animation class after animation completes
  setTimeout(() => {
    taskElement.classList.remove('new');
  }, 500);

  return taskElement;
}

    // Event Management
    // (Removed duplicate addEvent function to fix syntax error)

    function renderCalendar() {
      const calendarGrid = document.getElementById('calendarGrid');
      calendarGrid.innerHTML = '';

      const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
      const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
      const startDate = new Date(firstDay);
      startDate.setDate(startDate.getDate() - firstDay.getDay());

      const today = new Date();
      today.setHours(0, 0, 0, 0);

      for (let i = 0; i < 42; i++) {
        const currentDay = new Date(startDate);
        currentDay.setDate(startDate.getDate() + i);
        
        const dayElement = createDayElement(currentDay, today, firstDay, lastDay);
        calendarGrid.appendChild(dayElement);
      }
    }

    function createDayElement(date, today, firstDay, lastDay) {
      const dayElement = document.createElement('div');
      dayElement.className = 'calendar-day';
      
      // Add classes for styling
      if (date < firstDay || date > lastDay) {
        dayElement.classList.add('other-month');
      }
      
      if (date.getTime() === today.getTime()) {
        dayElement.classList.add('today');
      }

      const dayEvents = getEventsForDate(date);
      if (dayEvents.length > 0) {
        dayElement.classList.add('has-events');
      }

      // Create day content
      const dayNumber = document.createElement('div');
      dayNumber.className = 'day-number';
      dayNumber.textContent = date.getDate();

      const eventsContainer = document.createElement('div');
      eventsContainer.className = 'day-events';

      // Show up to 3 events
      dayEvents.slice(0, 3).forEach(event => {
        const eventIndicator = document.createElement('div');
        eventIndicator.className = 'event-indicator';
        eventIndicator.textContent = event.title;
        eventIndicator.title = `${event.title} - ${formatTime(event.datetime)}`;
        eventsContainer.appendChild(eventIndicator);
      });

      dayElement.appendChild(dayNumber);
      dayElement.appendChild(eventsContainer);

      // Add click event
      dayElement.addEventListener('click', () => showDayEvents(date, dayEvents));

      return dayElement;
    }

    function getEventsForDate(date) {
      const dateStr = date.toDateString();
      return events.filter(event => {
        const eventDate = new Date(event.datetime);
        return eventDate.toDateString() === dateStr;
      }).sort((a, b) => new Date(a.datetime) - new Date(b.datetime));
    }

    function showDayEvents(date, dayEvents) {
      const message = `${date.toLocaleDateString('en-US', { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      })}\n\n${dayEvents.length === 0 ? 'No events scheduled' : 
        dayEvents.map(event => `• ${event.title} at ${formatTime(event.datetime)}`).join('\n')}`;
      
      alert(message);
    }

    // Utility Functions
  // Updated updateStatistics function for index.html
function updateStatistics() {
  console.log("Updating statistics");
  
  const user = firebase.auth().currentUser;
  if (!user) {
    console.log("No authenticated user found");
    return;
  }
  
  const totalElement = document.getElementById('totalTasks');
  const completedElement = document.getElementById('completedTasks');
  const todayElement = document.getElementById('todayTasks');
  
  // Use the statistics from store.js if available
  if (window.taskStats) {
    if (totalElement) totalElement.textContent = window.taskStats.total;
    if (completedElement) completedElement.textContent = window.taskStats.completed;
    if (todayElement) todayElement.textContent = window.taskStats.today;
    return;
  }
  
  // If stats aren't available, fetch them directly
  const stats = {
    total: 0,
    completed: 0,
    today: 0
  };
  
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  const userTasksRef = firebase.database().ref('users/' + user.uid + '/tasks');
  userTasksRef.once('value')
    .then((snapshot) => {
      snapshot.forEach((childSnapshot) => {
        stats.total++;
        if (childSnapshot.val().completed) {
          stats.completed++;
        }
        
        const taskDate = new Date(childSnapshot.val().createdAt);
        taskDate.setHours(0, 0, 0, 0);
        if (taskDate.getTime() === today.getTime()) {
          stats.today++;
        }
      });
      
      // Update the UI
      if (totalElement) totalElement.textContent = stats.total;
      if (completedElement) completedElement.textContent = stats.completed;
      if (todayElement) todayElement.textContent = stats.today;
    })
    .catch((error) => {
      console.error("Error updating statistics:", error);
    });
}

// Add event listener for task statistics updates
document.addEventListener('taskStatsUpdated', function(e) {
  const stats = e.detail;
  console.log("Task statistics updated:", stats);
  
  const totalElement = document.getElementById('totalTasks');
  const completedElement = document.getElementById('completedTasks');
  const todayElement = document.getElementById('todayTasks');
  
  if (totalElement) totalElement.textContent = stats.total;
  if (completedElement) completedElement.textContent = stats.completed;
  if (todayElement) todayElement.textContent = stats.today;
});
    function formatDate(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const taskDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());

      const diffTime = taskDate.getTime() - today.getTime();
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

      if (diffDays === 0) return 'Today';
      if (diffDays === 1) return 'Tomorrow';
      if (diffDays === -1) return 'Yesterday';
      if (diffDays > 0 && diffDays <= 7) return `In ${diffDays} days`;
      if (diffDays < 0 && diffDays >= -7) return `${Math.abs(diffDays)} days ago`;

      return date.toLocaleDateString('en-US', { 
        month: 'short', 
        day: 'numeric',
        year: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined
      });
    }

    function formatTime(datetime) {
      const date = new Date(datetime);
      return date.toLocaleTimeString('en-US', { 
        hour: 'numeric', 
        minute: '2-digit',
        hour12: true 
      });
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;

      document.body.appendChild(notification);

      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 10);

      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          if (document.body.contains(notification)) {
            document.body.removeChild(notification);
          }
        }, 300);
      }, 3000);

      // Also try to show browser notification if permission granted
      if (Notification.permission === 'granted') {
        new Notification('TaskMate', {
          body: message,
          icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%235d5fef"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>'
        });
      }
    }

    function requestNotificationPermission() {
      if ('Notification' in window && Notification.permission === 'default') {
        Notification.requestPermission().then(permission => {
          if (permission === 'granted') {
            showNotification('Notifications enabled! You\'ll receive reminders for your tasks.', 'success');
          }
        });
      }
    }

    function setupNotificationChecks() {
      // Check for upcoming events every minute
      setInterval(() => {
        checkUpcomingEvents();
      }, 60000);
    }

   function checkUpcomingEvents() {
  const user = firebase.auth().currentUser;
  if (!user) return;
  
  const now = new Date();
  
  events.forEach(event => {
    const eventTime = new Date(event.datetime);
    const timeDiff = eventTime.getTime() - now.getTime();
    
    // Notify 15 minutes before event
    if (timeDiff > 0 && timeDiff <= 15 * 60 * 1000 && !event.notified) {
      showNotification(`Reminder: ${event.title} starts in 15 minutes!`, 'info');
      
      // Update Firebase to mark as notified
      const userEventsRef = database.ref('users/' + user.uid + '/events');
      userEventsRef.child(event.id).update({ notified: true }).catch((error) => {
        console.error('Error updating event notification status:', error);
      });
    }
  });
}
    // Add event listeners for the Smart To-Do List section
    const todoInput = document.getElementById('todoInput');
    const addBtn = document.getElementById('addBtn');

    if (addBtn) {
      addBtn.addEventListener('click', () => {
      const value = todoInput.value.trim();
      if (value) {
        addTask(value);
        todoInput.value = '';
        updateStatistics();
      }
      });
    }

    if (todoInput) {
      todoInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        const value = todoInput.value.trim();
        if (value) {
        addTask(value);
        todoInput.value = '';
        updateStatistics();
        }
      }
      });
    }
    // Scroll Effects
    function setupScrollEffects() {
      const navbar = document.getElementById('navbar');
      const scrollProgress = document.getElementById('scrollProgress');

      window.addEventListener('scroll', () => {
        // Scroll progress
        const scrollPercent = (window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100;
        scrollProgress.style.width = `${scrollPercent}%`;

        // Navbar background
        if (window.scrollY > 100) {
          navbar.classList.add('scrolled');
        } else { 
      
          navbar.classList.remove('scrolled');
        }
      });
    }

    // Reveal Animations
    function setupRevealAnimations() {
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.style.opacity = '1';
              entry.target.style.transform = 'translateY(0)';
            }
          });
        },
        { threshold: 0.1 }
      );

      const sections = document.querySelectorAll('.features-section, .page-container');
      sections.forEach(section => {
        section.style.opacity = '0';
        section.style.transform = 'translateY(40px)';
        observer.observe(section);
      });
    }

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      if (animationId) {
        cancelAnimationFrame(animationId);
      }
    });
  
  </script>
</body>
</html>
